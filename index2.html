<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promesas</title>
</head>
<body>
    
    <input type="text" id="campo" disabled>

    <script>

        // Promise y Fetch

          /*   console.log('Primer console.log');

            setTimeout(() => {
                console.log('Segundo console.log');
            }, 2000);

            console.log('Tercer console.log'); */

        // Una promesa es una OPERACION ASINCRONICA que puede ser RESUELTA o RECHAZADA

            

           /*  const promesa = new Promise((res,rej) => {
                let temperatura = 23;
                if (temperatura > 20) {
                   res('Ok');
               }else{
                    rej('Error');
                }
            });

            promesa.then(msj => document.write(msj))
                    .catch(err => console.error(err));

            // 1 - ejecuta la promesa
            // 2 - espera (await) a que se resuelva
            // 3 - promesa resuelta, entonces await devuelve el argumento de la funcion "res"

            async function miFuncion() {
                const msj = await promesa;
                console.log(msj);
            }

            miFuncion();
 */ 
            
            // API FETCH

            // 1 En que ambitos esta disponible
            //      window(Browser) - ServiceWorker (worker)

            // 2 Que provee al ambito global
            //       Funciones: fetch()
            //       Eventos: FetchEvent
            //       Objetos: Request y Response
            
            //      dentro del Request y Response
            //          estan las funciones constructoras

            let peticionHttp = new Request ('https://jsonplaceholder.typicode.com/users');

            console.log(peticionHttp);

            /* fetch(Request) => Promise<Response> */

            (async function() {
                const rta = await fetch('https://jsonplaceholder.typicode.com/users');
                const datos = await rta.json();

                if (rta.status == 200) {
                    console.log(datos);
                    document.querySelector('#campo').disabled = false;
    
                    document.querySelector('#campo').addEventListener('input', (e) => {
                        const mostrar = datos.filter(val => {
                            return val.name.includes(e.target.value);
                        });
                        console.log(mostrar);
                    });
                }else{
                    console.error('Error de conectividad');
                }

            })();

    </script>
</body>
</html>